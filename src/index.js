/** 360 4-byte emojis */
const EMOJIS = [
    "ðŸ˜€", "ðŸ˜ƒ", "ðŸ˜„", "ðŸ˜", "ðŸ˜†", "ðŸ˜…", "ðŸ˜‚", "ðŸ¤£", "ðŸ˜Š", "ðŸ˜‡", "ðŸ™‚", "ðŸ™ƒ", "ðŸ˜‰", "ðŸ˜Œ", "ðŸ˜", "ðŸ¥°", "ðŸ˜˜", "ðŸ˜—", "ðŸ˜™", "ðŸ˜", "ðŸ˜Ž", "ðŸ¤©", "ðŸ¥³", "ðŸ˜", "ðŸ˜’",
    "ðŸ˜ž", "ðŸ˜”", "ðŸ˜Ÿ", "ðŸ™", "ðŸ˜£", "ðŸ˜–", "ðŸ˜«", "ðŸ˜©", "ðŸ¥º", "ðŸ˜¢", "ðŸ˜­", "ðŸ˜¤", "ðŸ˜ ", "ðŸ˜¡", "ðŸ¤¬", "ðŸ¤¯", "ðŸ˜³", "ðŸ¥µ", "ðŸ¥¶", "ðŸ˜±", "ðŸ˜°", "ðŸ˜¥", "ðŸ˜“", "ðŸ¤—", "ðŸ¤”",
    "ðŸ¤­", "ðŸ¤«", "ðŸ¤¥", "ðŸ¤¢", "ðŸ¤®", "ðŸ¤§", "ðŸ˜·", "ðŸ¤’", "ðŸ‘‹", "ðŸ¤š", "ðŸ–", "ðŸ––", "ðŸ‘Œ", "ðŸ¤", "ðŸ¤ž", "ðŸ¤Ÿ", "ðŸ¤˜", "ðŸ¤™", "ðŸ‘ˆ", "ðŸ‘‰", "ðŸ‘†", "ðŸ–•", "ðŸ‘‡", "ðŸ‘", "ðŸ‘Ž","ðŸ¤›",
    "ðŸ¤", "ðŸ™", "ðŸ’…", "ðŸ¤³", "ðŸ’ª", "ðŸ¦¾", "ðŸ¦µ", "ðŸ¦¿", "ðŸ¦¶", "ðŸ‘‚", "ðŸ¦»", "ðŸ‘ƒ", "ðŸ§ ", "ðŸ¦·", "ðŸ¦´", "ðŸ‘€", "ðŸ‘…", "ðŸ‘„", "ðŸ’‹", "ðŸ©¸", "ðŸ§³", "ðŸŒ‚", "ðŸ§µ", "ðŸ§¶", "ðŸ‘“", "ðŸ¥½",
    "ðŸ¥¼", "ðŸ¦º", "ðŸ‘”", "ðŸ‘•", "ðŸ‘–", "ðŸ§£", "ðŸ§¥", "ðŸ§¦", "ðŸ‘—", "ðŸ‘˜", "ðŸ¥»", "ðŸ©±", "ðŸ©²", "ðŸ©³", "ðŸ‘™", "ðŸ‘š", "ðŸ‘›", "ðŸ‘", "ðŸŽ’", "ðŸ‘ž", "ðŸ‘Ÿ", "ðŸ¥¾", "ðŸ¥¿", "ðŸ‘ ", "ðŸ‘¡",
    "ðŸ©°","ðŸ‘¢", "ðŸ‘‘", "ðŸ‘’", "ðŸŽ©", "ðŸŽ“", "ðŸ§¢", "ðŸ’„", "ðŸ’", "ðŸ’¼", "ðŸ¶", "ðŸ±", "ðŸ­", "ðŸ¹", "ðŸ°", "ðŸ¦Š", "ðŸ»", "ðŸ¼", "ðŸ¨", "ðŸ¯", "ðŸ¦", "ðŸ®", "ðŸ·", "ðŸ½", "ðŸ¸",
    "ðŸµ", "ðŸ™ˆ","ðŸ™‰", "ðŸ™Š", "ðŸ’", "ðŸ”", "ðŸ§", "ðŸ¦", "ðŸ¤", "ðŸ£", "ðŸ¥", "ðŸ¦†", "ðŸ¦…", "ðŸ¦‰", "ðŸ¦‡", "ðŸº", "ðŸ—", "ðŸ´", "ðŸ¦„", "ðŸ", "ðŸ›", "ðŸ¦‹", "ðŸŒ", "ðŸž", "ðŸœ",
    "ðŸ¦Ÿ", "ðŸ¦—", "ðŸ¦‚","ðŸ¢", "ðŸ", "ðŸ¦Ž", "ðŸ¦–", "ðŸ¦•", "ðŸ™", "ðŸ¦‘", "ðŸ¦", "ðŸ¦ž", "ðŸ¡", "ðŸ ", "ðŸŸ", "ðŸ¬", "ðŸ³", "ðŸ‹", "ðŸ¦ˆ", "ðŸŠ", "ðŸ…", "ðŸ†", "ðŸ¦“", "ðŸ¦§", "ðŸ˜",
    "ðŸ¦›", "ðŸ¦", "ðŸ¦¥", "ðŸ","ðŸ€", "ðŸ¦”", "ðŸ¾", "ðŸ‰", "ðŸ²", "ðŸŒ³", "ðŸŒ´", "ðŸŒ±", "ðŸŒ¿", "ðŸŽ", "ðŸŽ‹", "ðŸƒ", "ðŸ‚", "ðŸ", "ðŸš", "ðŸŒ¾", "ðŸ’", "ðŸŒ·", "ðŸŒ¹", "ðŸ¥€", "ðŸŒº",
    "ðŸŒ¸", "ðŸŒ¼", "ðŸŒ»", "ðŸŒž", "ðŸŒ", "ðŸŒ›","ðŸŒœ", "ðŸŒš", "ðŸŒ“", "ðŸŒ™", "ðŸŒŽ", "ðŸŒ", "ðŸª", "ðŸ’«", "ðŸŽ‡", "ðŸŒŸ", "ðŸ”¥", "ðŸŒˆ", "ðŸ’¨", "ðŸ’¦", "ðŸŒŠ", "ðŸ“±", "ðŸ“²", "ðŸ’»", "ðŸ’½",
    "ðŸ’¾", "ðŸ’¿", "ðŸ“€", "ðŸ“¼", "ðŸ“·", "ðŸ“¸", "ðŸ“¹", "ðŸŽ¥","ðŸ“ž", "ðŸ“Ÿ", "ðŸ“ ", "ðŸ“º", "ðŸ“»", "ðŸ§­", "ðŸ“¡", "ðŸ§°", "ðŸ”§", "ðŸ”¨", "ðŸ”©", "ðŸ§±", "ðŸš½", "ðŸš°", "ðŸš¿", "ðŸ§¸", "ðŸ›’",
    "ðŸŽ", "ðŸŽˆ", "ðŸŽ", "ðŸŽ€", "ðŸŽŠ", "ðŸŽ‰", "ðŸŽŽ", "ðŸ®", "ðŸŽ", "ðŸ§§","ðŸ“©", "ðŸ“¨", "ðŸ“§", "ðŸ’Œ", "ðŸ“¥", "ðŸ“¤", "ðŸ“¦", "ðŸ“ª", "ðŸ“«", "ðŸ“¬", "ðŸ“­", "ðŸ“®", "ðŸ“¯", "ðŸ“œ", "ðŸ“ƒ", "ðŸ“„",
    "ðŸ“Š", "ðŸ“ˆ", "ðŸ“‰", "ðŸ“†", "ðŸ“…", "ðŸ“‡", "ðŸ“‹", "ðŸ“", "ðŸ“‚", "ðŸ“°", "ðŸ““","ðŸ“”", "ðŸ“’", "ðŸ“•", "ðŸ“—", "ðŸ“˜", "ðŸ“™", "ðŸ”®", "ðŸ“–", "ðŸ”–", "ðŸ§·", "ðŸ”—", "ðŸ“Ž", "ðŸ“", "ðŸ“", "ðŸ§®",
    "ðŸ“Œ", "ðŸ“", "ðŸ“", "ðŸ”", "ðŸ”Ž", "ðŸ”", "ðŸ”", "ðŸ”’", "ðŸ”“", "ðŸ…¿", "ðŸ• ", "ðŸšƒ", "ðŸ’·","ðŸŽ¿", "ðŸ’¯", "ðŸš‚", "ðŸ", "ðŸš¶", "ðŸ¯", "ðŸŽ¬", "ðŸ’", "ðŸ’ ", "ðŸ‘¥", "ðŸ’¢", "ðŸˆ¯",
    "ðŸ”½", "ðŸ‰‘", "ðŸ“š", "ðŸ•˜", "ðŸŒ–", "ðŸŽª"
];

/** The numeral base used */
const BASE = 360n;

/** Split by emoji */
const EMOJI_SPLIT_RE = new RegExp('.{1,2}', 'g');

/**
 * Encode a numeral value into base360
 * @param {Number|String|BigInt|Boolean} integer Any numeral value
 * @returns {String}
 */
const encode = (integer) => {
    let number = BigInt(integer);
    let emojiNumber = "";

    if (number === 0n) return EMOJIS[0];
    while (number !== 0n) {
        const d = number / BASE;
        const r = number % BASE;
        number = d;
        emojiNumber = EMOJIS[r] + emojiNumber;
    }

    return emojiNumber;
}

/**
 * Decode a base360 emoji string back into its BigInt numeral form
 * @param {String} emojiNumber Emoji string
 * @returns {bigint}
 */
const decode = (emojiNumber) => {
    const split = emojiNumber.match(EMOJI_SPLIT_RE);
    let length = split.length;
    const digits = length;
    let number = BigInt(0);

    for (let i = 0; i < digits; i++) {
        length -= 1;
        const index = EMOJIS.indexOf(split[i]);
        number += BigInt(index) * (BASE ** BigInt(length));
    }

    return number;
}

module.exports = { encode, decode };
